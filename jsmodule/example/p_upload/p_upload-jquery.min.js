/*! p_upload tianxiangbing http://www.lovewebgames.com/jsmodule/p_upload.html 2015-03-18 */
function P_upload(){var a=Math.random().toString().replace(".","");this.id="upload_"+a,this.fileInput}P_upload.prototype={init:function(a){this.settings=$.extend({},this.settings,a),this.target=this.settings.target,$(this.target).after('<input type="file"  accept="image/*" id="'+this.id+'"/>'),this.fileInput=$("#"+this.id),this.name=this.settings.name||"files",this.fileInput.hide(),this.settings.multiple&&this.fileInput.attr("multiple","multiple"),this.bindEvent()},bindEvent:function(){var a=this;$(this.target).click(function(){$(a.fileInput).trigger("click")}),$(this.fileInput).change(function(b){for(var c=/^image\//i,d=b.target.files,e=d.length-1;e>=0;e--){var f=d[e];if(!c.test(f.type)){alert("不是图片文件");break}var g=new FileReader;g.onload=function(){a.settings.callback&&a.settings.callback(this.result,f,a.name)},g.readAsDataURL(f)}})}},function(a){a.fn.P_upload=function(b){var c=[];return a(this).each(function(){var c=new P_upload,d=a.extend({target:a(this)},b);c.init(d)}),c}}(jQuery);