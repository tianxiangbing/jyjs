function querystring(a,b){var c=new RegExp(""+b+"=([^&?]*)","ig");return a.match(c)?a.match(c)[0].substr(b.length+1):null}(function(a){a.fn.moveScroll=function(b){function j(){f=false;h.hide();h.unbind("click");if(g)clearInterval(g)}function i(a,b){h.show().css("left",a).css("top",b);f=true}var c={speed:40,step:10};if(b)a.extend(c,b);var d=a(this);var e=d.children();var f=false;a("body").append('<div style="width:50px;position:absolute;display:none;font-size:20px;font-weight:bolder; background-color:gray;filter:alpha(opacity=50);opacity: 0.5; -moz-opacity:0.5;cursor:pointer;" id="scrollBar">></div>');var g;var h=a("#scrollBar");h.css("height",d.height());d.mouseover(function(){a(this).bind("mousemove",function(a){var b=a.clientX-d.offset().left;if(b>d.width()-50&&!f&&d.scrollLeft()<e.get(0).clientWidth-d.width()){h.html(">>");i(d.width()+d.offset().left-50,d.offset().top);h.attr("pos","right");if(f)h.bind("click",function(){var a=parseInt(d.scrollLeft())+c.step;d.animate({scrollLeft:a},c.speed)})}else{j()}if(b<50&&!f&&d.scrollLeft()>0){i(d.offset().left,d.offset().top);h.html(" <<");h.attr("pos","left");if(f)h.bind("click",function(){var a=parseInt(d.scrollLeft())-c.step;a=a<0?0:a;d.animate({scrollLeft:a},c.speed)})}})}).mouseout(function(){a(this).unbind("mousemove")});d.scroll(function(){if((d.scrollLeft()>=e.get(0).clientWidth-d.width()||d.scrollLeft()==0)&&f){j();h.unbind("click")}});h.mouseout(j);h.mousedown(function(a){g=setInterval(function(){var a=0;switch(h.attr("pos")){case"left":{a=parseInt(d.scrollLeft())-10;a=a<0?0:a}break;case"right":{a=parseInt(d.scrollLeft())+10}break}d.scrollLeft(a)},40)}).mouseup(function(){if(g)clearInterval(g)})}})(jQuery);(function(a){a.fn.autoAdd=function(b){function i(){d.find("."+c.indexClass).each(function(b,c){a(this).html(b+1)})}function h(a){a.remove();e=d.find("."+c.tempRowClass).length;c.changeInput.val(e);if(c.delCallBack)c.delCallBack(d.children().eq(j));g();i()}function g(){d.find("."+c.tempRowClass).find("."+c.moveUpClass+",."+c.moveDownClass).show();d.find("."+c.tempRowClass).first().find("."+c.moveUpClass).hide();d.find("."+c.tempRowClass).last().find("."+c.moveDownClass).hide()}function f(b,f,j){for(var k=0;k<b-e;k++){var l=d.find("."+c.tempRowClass).first().clone(true);l.find("input").val("");l.find("select").val("-1");l.find("textarea").val("");l.find(":checkbox").attr("checked",false);l.attr("id","");l.find("input,tr,textarea,select,:checkbox,tbody").attr("id","");if(l.find(".richText").length>0){l.find(".ke-container").remove()}l.find(".richText,input").each(function(){a(this).attr("id","txt_"+Math.round(Math.random()*(new Date).getTime()));a(this).show()});if(f){l.insertBefore(j.closest("."+c.tempRowClass))}else{d.append(l)}}if(b<e){for(var m=e-1;m>=b;m--){h(d.find("."+c.tempRowClass).eq(m))}}else{if(c.addCallBack)c.addCallBack(a(l))}e=d.find("."+c.tempRowClass).length;c.changeInput.val(e);i();g()}var c={changeInput:a("#input"),tempRowClass:"tempRow",min:1,max:90,addButtonClass:"addbtn",delButtonClass:"delbtn",addCallBack:null,delCallBack:null,indexClass:"index",insertClass:"insertbtn",moveUpClass:"moveupbtn",moveDownClass:"movedownbtn"};if(b)a.extend(c,b);var d=this;var e=d.find("."+c.tempRowClass).length;c.changeInput.change(function(){if(/^\d+$/.test(a(this).val())){if(a(this).val()>c.max||a(this).val()<c.min){alert("请输入大于等于 "+c.min+" 并且小于等于 "+c.max+" 的数!");if(a(this).val()>c.max)a(this).val(c.max);if(a(this).val()<c.min)a(this).val(c.min);a(this).change()}else{f(a(this).val())}}else{alert("请输入有效的整数！");a(this).val("");a(this).focus()}});d.find("."+c.tempRowClass).each(function(){a(this).find(".richText,input").each(function(){if(a(this).attr("id").length==0)a(this).attr("id","txt_"+Math.round(Math.random()*(new Date).getTime()))})});d.find("."+c.addButtonClass).bind("click",function(){if(e>=c.max){alert("最多只能添加 "+c.max+" 行记录!")}else{f(e+1)}return false});d.find("."+c.insertClass).bind("click",function(){if(e>=c.max){alert("最多只能添加 "+c.max+" 行记录!")}else{f(e+1,true,a(this))}return false});d.find("."+c.moveUpClass).bind("click",function(){a(this).closest("."+c.tempRowClass).insertBefore(a(this).closest("."+c.tempRowClass).prev("."+c.tempRowClass));g();i();return false});d.find("."+c.moveDownClass).bind("click",function(){a(this).closest("."+c.tempRowClass).insertAfter(a(this).closest("."+c.tempRowClass).next("."+c.tempRowClass));g();i();return false});d.find("."+c.delButtonClass).bind("click",function(){if(e>c.min){e--;h(a(this).closest("."+c.tempRowClass))}else{alert("需至少保留 "+c.min+" 行记录!")}return false});g()}})(jQuery);$(function(){$(".autoAdd").each(function(){$(this).autoAdd()})})