!function(a,b){"function"==typeof define&&define.amd?define(["$"],b):"object"==typeof exports?module.exports=b():a.WordCount=b(window.Zepto||window.jQuery||$)}(this,function(a){a.fn.WordCount=function(c){var d=[];return a(this).each(function(){var e=new b,f=a.extend({trigger:a(this)},c);e.init(f),d.push(e)}),d};var b=function(){};return b.prototype={init:function(b){var c=this;this.args=b,this.textBox=a(b.trigger),this.settings=a.extend({},b),this.oldNumber=0,this.minHeight=b.minHeight,this.number=0,this.timer=null,this.overClass=b.overClass||"",this.changeCallback=b.changeCallback||null,this.max=0,this.overflowCallback=b.overflowCallback||null,this.passClallback=b.passClallback||null,this.isOverflowCut=b.isOverflowCut||!0,c.withButton=a(b.withButton),this.num=a(b.num),c.max=b.max||parseInt(c.textBox.attr("maxLength"))||0,c.textBox.bind("focus",function(){c.start()}).bind("blur",function(a){clearInterval(c.timer)}),this.bindEvent(),this.checkNum()},bindEvent:function(){var a=this;this.touch(this.withButton,function(){return a.getFullNumber(),a.max&&a.number>a.max?(a.twinkle().done(function(){a.twinkle()}),!1):!0})},twinkle:function(){var a=this,b=null;return setTimeout(function(){a.textBox.addClass("error-number"),setTimeout(function(){a.textBox.removeClass("error-number"),b&&b()},100)},100),{done:function(a){b=a}}},touch:function(b,c,d){function e(a){return d.call(this,a)}var f;"function"==typeof c&&(d=c),a(b).on("touchmove",c,function(a){f=!0}).on("touchend",c,function(a){if(a.preventDefault(),!f){var b=d.call(this,a,"touch");b===!1&&(a.preventDefault(),a.stopPropagation())}f=!1}),a(b).on("mousedown",c,e)},start:function(){var a=this;a.timer=setInterval(function(){a.checkNum()},20)},checkNum:function(){var a=this;a.getFullNumber(),a.number!==a.oldNumber&&a.changeCallback&&(a.max&&a.number>a.max?a.overflowCallback?(a.num.addClass(a.overClass),a.textBox.addClass(a.overClass).attr("data-overflow",!0),a.overflowCallback(a,a.number,a.textBox,a.max)):a.isOverflowCut&&(a.textBox.val(a.textBox.val().slice(0,a.max)),a.getFullNumber()):(a.num.removeClass(a.overClass),a.textBox.removeClass(a.overClass).attr("data-overflow",""),a.passClallback&&a.passClallback.call(a,a.number,a.textBox,a.max)),a.num.html(a.max-a.number),a.changeCallback.call(a,a.number)),a.oldNumber=a.number,a.settings.minHeight&&(a.textBox.height(a.minHeight),a.textBox.height(a.textBox[0].scrollHeight))},getNumber:function(){return this.args.isByte?this.number=this.textBox.val().replace(/[^\x00-\xff]/g,"**").length:this.number=this.textBox.val().length,this.number},getFullNumber:function(){return this.number=this.textBox.val().replace(/[^\x00-\xff]/g,"**").length,this.number}},b});