!function(a,b){"function"==typeof define&&define.amd?define([],b):"object"==typeof exports?module.exports=b():a.LocalStorageCache=b()}(this,function(){var a={add:function(a,b,c){"object"==typeof vallue&&(b=JSON.stringify(b)),c=this._getExp(c);var d={data:b,expired:c,time:+new Date};localStorage.setItem(a,JSON.stringify(d))},get:function(a,b){var c=JSON.parse(localStorage.getItem(a)),d=$.Deferred(),e=this;if(null==c)b?b().fail(function(){d.reject(null)}).done(function(b){e.add(a,b),d.resolve(b)}):d.reject(null);else if(c.expired>0){var f=+new Date;f>c.expired?b?b().fail(function(){d.reject(c.data)}).done(function(b){e.update(a,b),d.resolve(b)}):d.reject(null):d.resolve(c.data)}else d.resolve(c.data);return d.promise()},remove:function(a){localStorage.removeItem(a)},clear:function(){localStorage.clear()},update:function(a,b,c){"object"==typeof vallue&&(b=JSON.stringify(b)),c=this._getExp(c);var d=JSON.parse(localStorage.getItem(a));null!=d&&("undefined"==typeof c||""==c?c=d.expired:null);var e={data:b,expired:c,time:+new Date};localStorage.setItem(a,JSON.stringify(e))},setExpired:function(a,b){b=this._getExp(b);var c=JSON.parse(localStorage.getItem(a));c.expired=b,localStorage.setItem(a,JSON.stringify(c))},_getExp:function(a){if(0==a){var b=this;window.onbeforeunload=function(){b.remove(key)}}else if("number"!=typeof a&&isNaN(Number(a)))"object"==typeof a&&(a=a.getTime()||-1);else{var c=+new Date;a=c+1e3*a}return a}};return a});